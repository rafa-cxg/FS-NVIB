
| distributed init (rank 0): env://
Namespace(batch_size=1, num_classes=1000, epochs=100, fp16=False, output_dir='outputs/original_diet_small_lr1e-4', device='cuda', seed=0, data_path='/datasets01/imagenet_full_size/061417/', pretrained_checkpoint_path='.', dataset='cifar_fs', nClsEpisode=5, nSupport=5, nQuery=15, nValEpisode=120, nEpisode=2000, image_size=128, base_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], val_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], test_sources=['traffic_sign', 'mscoco', 'ilsvrc_2012', 'omniglot', 'aircraft', 'cu_birds', 'dtd', 'quickdraw', 'fungi', 'vgg_flower'], shuffle=True, train_transforms=['random_resized_crop', 'jitter', 'random_flip', 'to_tensor', 'normalize'], test_transforms=['resize', 'center_crop', 'to_tensor', 'normalize'], num_ways=None, num_support=None, num_query=None, min_ways=5, max_ways_upper_bound=50, max_num_query=10, max_support_set_size=500, max_support_size_contrib_per_class=100, min_examples_in_class=0, min_log_weight=-0.6931471805599453, max_log_weight=0.6931471805599453, ignore_bilevel_ontology=False, ignore_dag_ontology=False, ignore_hierarchy_probability=0.0, test_n_way=5, n_shot=5, cdfsl_domains=['EuroSAT', 'ISIC', 'CropDisease', 'ChestX'], arch='deit_small_patch16', patch_size=16, pretrained_weights='', checkpoint_key='teacher', unused_params=False, no_pretrain=True, deploy='vanilla', num_adapters=1, ada_steps=40, ada_lr=0.05, aug_prob=0.9, aug_types=['color', 'translation'], img_size=224, drop=0.0, drop_path=0.1, model_ema=False, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', lr=1e-05, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=1e-06, min_lr=1e-06, decay_epochs=30, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, color_jitter=0.4, aa='rand-m9-mstd0.5-inc1', smoothing=0.0, train_interpolation='bicubic', repeated_aug=False, reprob=0.25, remode='pixel', recount=1, resplit=False, mixup=0.0, cutmix=0.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', teacher_model='regnety_160', teacher_path='', distillation_type='none', distillation_alpha=0.5, distillation_tau=1.0, resume='', start_epoch=0, eval=False, dist_eval=True, num_workers=10, pin_mem=True, world_size=1, dist_url='env://', nvib=True, delta=1.0, alpha_tau=-10.0, stdev_tau=0.0, lambda_klg=0.0, lambda_kld=0.0, nvib_layers=[0, 1, 2, 3, 4, 5], rank=0, gpu=0, distributed=True, dist_backend='nccl')
Creating model: ProtoNet deit_small_patch16
Using NVIB Vision Transformer
Layer 0 has nvib_layer
Layer 1 has nvib_layer
Layer 2 has nvib_layer
Layer 3 has nvib_layer
Layer 4 has nvib_layer
Layer 5 has nvib_layer
number of params: 23444360
Start training for 100 epochs
pydev debugger: warning: trying to add breakpoint to file that does not exist: /home/rafa/fs_learning/c:/users/rafa/appdata/local/jetbrains/pycharm2022.2/remote_sources/1130872187/201545293/argparse.py (will have no effect)
pydev debugger: warning: trying to add breakpoint to file that does not exist: /home/rafa/fs_learning/c:/users/rafa/appdata/local/jetbrains/pycharm2022.2/remote_sources/1130872187/201545293/argparse.py (will have no effect)
pydev debugger: warning: trying to add breakpoint to file that does not exist: /home/rafa/fs_learning/c:/users/rafa/appdata/local/jetbrains/pycharm2022.2/remote_sources/1130872187/201545293/argparse.py (will have no effect)
pydev debugger: warning: trying to add breakpoint to file that does not exist: /home/rafa/fs_learning/c:/users/rafa/appdata/local/jetbrains/pycharm2022.2/remote_sources/1130872187/201545293/argparse.py (will have no effect)
pydev debugger: warning: trying to add breakpoint to file that does not exist: /home/rafa/fs_learning/c:/users/rafa/appdata/local/jetbrains/pycharm2022.2/remote_sources/1130872187/201545293/argparse.py (will have no effect)
pydev debugger: warning: trying to add breakpoint to file that does not exist: /home/rafa/fs_learning/c:/users/rafa/appdata/local/jetbrains/pycharm2022.2/remote_sources/1130872187/201545293/argparse.py (will have no effect)
pydev debugger: warning: trying to add breakpoint to file that does not exist: /home/rafa/fs_learning/c:/users/rafa/appdata/local/jetbrains/pycharm2022.2/remote_sources/1130872187/201545293/argparse.py (will have no effect)
pydev debugger: warning: trying to add breakpoint to file that does not exist: /home/rafa/fs_learning/c:/users/rafa/appdata/local/jetbrains/pycharm2022.2/remote_sources/1130872187/201545293/argparse.py (will have no effect)
pydev debugger: warning: trying to add breakpoint to file that does not exist: /home/rafa/fs_learning/c:/users/rafa/appdata/local/jetbrains/pycharm2022.2/remote_sources/1130872187/201545293/argparse.py (will have no effect)
pydev debugger: warning: trying to add breakpoint to file that does not exist: /home/rafa/fs_learning/c:/users/rafa/appdata/local/jetbrains/pycharm2022.2/remote_sources/1130872187/201545293/argparse.py (will have no effect)
tensor([[[-2.4809e-02, -1.5954e-01, -1.8162e-03,  ..., -2.1610e-01,
          -5.4237e-02, -3.2009e-02],
         [-6.8121e-05,  3.0452e-04, -1.3429e-04,  ..., -5.9103e-04,
          -4.4659e-04, -3.4579e-04],
         [-3.4144e-05,  3.2227e-04, -2.9938e-04,  ..., -4.4308e-04,
          -4.6065e-04, -2.5928e-04],
         ...,
         [-2.2564e-04,  1.2889e-04, -2.4456e-04,  ..., -6.2143e-04,
          -5.3739e-04, -2.0066e-04],
         [-1.9446e-04,  1.5400e-04, -1.7515e-04,  ..., -3.9711e-04,
          -5.4060e-04, -2.6033e-04],
         [-1.6437e-04,  1.7379e-04, -2.2383e-04,  ..., -4.7201e-04,
          -4.8548e-04, -1.3686e-04]]], device='cuda:0')
Epoch: [0]  [   0/2000]  eta: 4:46:16  lr: 0.000001  n_ways: 5  n_imgs: 100  loss: 2.5577 (2.5577)  time: 8.5884  data: 1.3307  max mem: 8274
tensor([[[-4.7260e-03, -1.3744e-02,  2.6460e-02,  ..., -4.8228e-02,
          -2.4958e-02, -5.7261e-02],
         [ 2.4057e-05,  2.7966e-04,  3.7088e-05,  ...,  3.6348e-04,
           6.1617e-05, -5.0855e-04],
         [ 1.2469e-04,  3.2357e-04,  4.4096e-05,  ...,  3.5091e-04,
          -7.1091e-05, -5.6971e-04],
         ...,
         [ 1.8634e-04,  2.7590e-04,  2.4281e-04,  ..., -1.2497e-05,
          -1.2179e-04, -4.8891e-04],
         [ 1.7186e-04,  2.8949e-04,  2.0746e-04,  ...,  1.5248e-04,
           1.8269e-04, -5.1979e-04],
         [ 8.9913e-05,  3.2962e-04,  1.8774e-04,  ...,  2.6525e-04,
           1.4261e-04, -3.6954e-04]]], device='cuda:0')
tensor([[[ 4.7661e-03,  2.1363e-01,  6.5253e-02,  ..., -6.7793e-03,
          -3.2740e-02, -1.9064e-01],
         [ 1.8437e-04,  9.3471e-05, -1.2228e-04,  ...,  7.9694e-04,
          -5.8598e-04, -3.0154e-04],
         [ 1.4244e-04,  9.9026e-05, -2.0523e-04,  ...,  1.0087e-03,
          -4.7542e-04, -1.0305e-04],
         ...,
         [-2.3609e-04,  2.6571e-04,  3.5076e-05,  ..., -5.6463e-04,
          -1.8520e-03, -4.0903e-04],
         [ 3.0026e-05,  8.0211e-05, -2.8566e-04,  ..., -2.0098e-04,
          -1.1708e-03, -5.4380e-04],
         [-1.3479e-04, -2.7921e-05, -2.6003e-04,  ..., -2.4689e-04,
          -1.0894e-03, -7.4487e-04]]], device='cuda:0')