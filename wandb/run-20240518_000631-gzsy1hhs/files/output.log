
| distributed init (rank 0): env://
Namespace(batch_size=1, num_classes=1000, epochs=100, fp16=False, output_dir='outputs/original_diet_small_lr1e-4', device='cuda', seed=0, data_path='/datasets01/imagenet_full_size/061417/', pretrained_checkpoint_path='.', dataset='cifar_fs', nClsEpisode=5, nSupport=5, nQuery=15, nValEpisode=120, nEpisode=2000, image_size=128, base_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], val_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], test_sources=['traffic_sign', 'mscoco', 'ilsvrc_2012', 'omniglot', 'aircraft', 'cu_birds', 'dtd', 'quickdraw', 'fungi', 'vgg_flower'], shuffle=True, train_transforms=['random_resized_crop', 'jitter', 'random_flip', 'to_tensor', 'normalize'], test_transforms=['resize', 'center_crop', 'to_tensor', 'normalize'], num_ways=None, num_support=None, num_query=None, min_ways=5, max_ways_upper_bound=50, max_num_query=10, max_support_set_size=500, max_support_size_contrib_per_class=100, min_examples_in_class=0, min_log_weight=-0.6931471805599453, max_log_weight=0.6931471805599453, ignore_bilevel_ontology=False, ignore_dag_ontology=False, ignore_hierarchy_probability=0.0, test_n_way=5, n_shot=5, cdfsl_domains=['EuroSAT', 'ISIC', 'CropDisease', 'ChestX'], arch='deit_small_patch16', patch_size=16, pretrained_weights='', checkpoint_key='teacher', unused_params=False, no_pretrain=True, deploy='vanilla', num_adapters=1, ada_steps=40, ada_lr=0.05, aug_prob=0.9, aug_types=['color', 'translation'], img_size=224, drop=0.0, drop_path=0.1, model_ema=False, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', lr=1e-05, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=1e-06, min_lr=1e-06, decay_epochs=30, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, color_jitter=0.4, aa='rand-m9-mstd0.5-inc1', smoothing=0.0, train_interpolation='bicubic', repeated_aug=False, reprob=0.25, remode='pixel', recount=1, resplit=False, mixup=0.0, cutmix=0.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', teacher_model='regnety_160', teacher_path='', distillation_type='none', distillation_alpha=0.5, distillation_tau=1.0, resume='', start_epoch=0, eval=False, dist_eval=True, num_workers=10, pin_mem=True, world_size=1, dist_url='env://', nvib=True, delta=1.0, alpha_tau=-8.0, stdev_tau=0.0, lambda_klg=0.0, lambda_kld=0.0, nvib_layers=[0, 1, 2, 3, 4, 5], rank=0, gpu=0, distributed=True, dist_backend='nccl')
Creating model: ProtoNet deit_small_patch16
Using NVIB Vision Transformer
Layer 0 has nvib_layer
Layer 1 has nvib_layer
Layer 2 has nvib_layer
Layer 3 has nvib_layer
Layer 4 has nvib_layer
Layer 5 has nvib_layer
number of params: 23444360
Start training for 100 epochs
tensor([[[-2.4806e-02, -1.5955e-01, -1.8162e-03,  ..., -2.1609e-01,
          -5.4228e-02, -3.2003e-02],
         [-6.8045e-05,  3.0460e-04, -1.3423e-04,  ..., -5.9076e-04,
          -4.4649e-04, -3.4571e-04],
         [-3.3994e-05,  3.2234e-04, -2.9929e-04,  ..., -4.4293e-04,
          -4.6054e-04, -2.5920e-04],
         ...,
         [-2.2587e-04,  1.2895e-04, -2.4475e-04,  ..., -6.2168e-04,
          -5.3741e-04, -2.0049e-04],
         [-1.9418e-04,  1.5431e-04, -1.7475e-04,  ..., -3.9676e-04,
          -5.4072e-04, -2.6030e-04],
         [-1.6435e-04,  1.7386e-04, -2.2385e-04,  ..., -4.7204e-04,
          -4.8540e-04, -1.3668e-04]]], device='cuda:0')
Epoch: [0]  [   0/2000]  eta: 4:14:03  lr: 0.000001  n_ways: 5  n_imgs: 100  loss: 2.5576 (2.5576)  time: 7.6220  data: 1.4696  max mem: 8274
tensor([[[-4.7298e-03, -1.3747e-02,  2.6458e-02,  ..., -4.8233e-02,
          -2.4965e-02, -5.7265e-02],
         [ 2.4071e-05,  2.7973e-04,  3.7213e-05,  ...,  3.6344e-04,
           6.1541e-05, -5.0867e-04],
         [ 1.2462e-04,  3.2347e-04,  4.4024e-05,  ...,  3.5081e-04,
          -7.1194e-05, -5.6955e-04],
         ...,
         [ 1.8625e-04,  2.7574e-04,  2.4272e-04,  ..., -1.2836e-05,
          -1.2212e-04, -4.8875e-04],
         [ 1.7185e-04,  2.8967e-04,  2.0762e-04,  ...,  1.5256e-04,
           1.8286e-04, -5.1980e-04],
         [ 8.9878e-05,  3.2959e-04,  1.8783e-04,  ...,  2.6522e-04,
           1.4275e-04, -3.6960e-04]]], device='cuda:0')
tensor([[[ 4.7622e-03,  2.1363e-01,  6.5248e-02,  ..., -6.7803e-03,
          -3.2738e-02, -1.9065e-01],
         [ 1.8432e-04,  9.3612e-05, -1.2249e-04,  ...,  7.9731e-04,
          -5.8544e-04, -3.0186e-04],
         [ 1.4237e-04,  9.8954e-05, -2.0506e-04,  ...,  1.0084e-03,
          -4.7481e-04, -1.0336e-04],
         ...,
         [-2.3608e-04,  2.6575e-04,  3.5178e-05,  ..., -5.6458e-04,
          -1.8519e-03, -4.0909e-04],
         [ 3.0050e-05,  7.9923e-05, -2.8584e-04,  ..., -2.0062e-04,
          -1.1703e-03, -5.4416e-04],
         [-1.3486e-04, -2.8146e-05, -2.6002e-04,  ..., -2.4709e-04,
          -1.0891e-03, -7.4462e-04]]], device='cuda:0')
tensor([[[-2.3793e-02, -2.0068e-02,  3.7564e-03,  ..., -4.6906e-02,
          -5.3056e-02,  2.4384e-02],
         [-1.9102e-04,  2.2540e-04,  1.0635e-04,  ..., -7.2070e-04,
          -3.3755e-04, -5.3101e-04],
         [-1.9343e-04,  1.2091e-04,  8.1838e-05,  ..., -7.0799e-04,
          -6.1398e-04, -5.4817e-04],
         ...,
         [-9.3286e-05,  2.1062e-04,  5.0372e-05,  ..., -2.9923e-04,
          -5.2473e-04, -1.7560e-04],
         [-8.6755e-05,  2.6450e-04,  6.3061e-05,  ..., -2.8252e-04,
          -5.7654e-04, -2.0941e-04],
         [-3.7597e-05,  4.0112e-04,  2.8912e-05,  ..., -2.5451e-04,
          -5.3341e-04, -2.1139e-04]]], device='cuda:0')
tensor([[[ 5.5663e-02,  2.4876e-01,  1.1776e-01,  ..., -5.9116e-02,
           7.9284e-02, -1.4436e-01],
         [ 2.6147e-05,  4.1138e-04, -9.0917e-05,  ...,  3.7375e-04,
          -2.7396e-04, -5.9780e-04],
         [-1.8508e-05,  4.7093e-04, -7.7859e-05,  ...,  8.1234e-04,
           3.2761e-04, -8.8345e-04],
         ...,
         [ 2.2940e-04,  4.6683e-04, -2.8249e-04,  ...,  8.2940e-04,
           4.8783e-04, -9.0364e-04],
         [ 2.9672e-04,  6.1352e-04, -2.3269e-04,  ...,  8.3527e-04,
           1.1989e-04, -9.1251e-04],
         [ 8.8703e-05,  4.8264e-04, -1.9951e-04,  ...,  3.6937e-04,
          -1.8060e-05, -9.0954e-04]]], device='cuda:0')
tensor([[[-1.9778e-02,  2.3886e-02,  3.3281e-02,  ..., -6.9006e-02,
          -9.9118e-02, -8.3580e-02],
         [ 2.0245e-04,  3.1473e-04,  5.2658e-05,  ...,  1.7864e-04,
           6.0608e-05, -7.2021e-04],
         [ 1.2598e-04,  3.8993e-04,  1.1766e-04,  ...,  3.1181e-04,
          -1.6194e-04, -9.2241e-04],
         ...,
         [ 1.7160e-04,  3.6142e-04, -6.8675e-05,  ...,  2.5643e-04,
          -5.0708e-04, -8.0317e-04],
         [ 8.5491e-05,  4.1828e-04, -4.7195e-05,  ...,  9.7858e-05,
          -6.4953e-04, -6.5222e-04],
         [ 6.3244e-05,  4.2411e-04, -7.6481e-05,  ...,  5.9186e-05,
          -7.9801e-04, -6.8652e-04]]], device='cuda:0')
tensor([[[-1.9208e-02,  1.1498e-01,  7.9137e-02,  ..., -8.9150e-02,
          -9.9660e-02, -1.1903e-01],
         [ 1.1390e-04,  8.8567e-05, -1.7894e-05,  ..., -5.2535e-05,
           3.2896e-05, -5.8828e-04],
         [ 1.3648e-04,  1.1427e-04, -9.8867e-05,  ...,  1.6035e-04,
          -1.8043e-04, -5.9802e-04],
         ...,
         [ 1.3894e-04,  5.0923e-04,  1.9033e-05,  ...,  2.4308e-04,
           3.2083e-05, -7.6076e-04],
         [ 5.3572e-05,  4.0027e-04, -1.1568e-05,  ..., -1.5410e-05,
           1.5050e-04, -6.4906e-04],
         [ 1.9228e-04,  4.5632e-04,  1.6796e-04,  ...,  2.4339e-05,
           2.2904e-04, -5.7826e-04]]], device='cuda:0')
tensor([[[-4.2179e-02,  6.7546e-02,  6.4941e-02,  ...,  9.9356e-02,
           4.5300e-02,  1.2727e-03],
         [ 4.0663e-04, -4.0622e-04,  3.4351e-04,  ...,  5.0806e-04,
           1.1999e-03, -9.3182e-04],
         [ 2.3585e-04, -3.4798e-04,  2.0814e-04,  ...,  7.4271e-04,
           1.3596e-03, -7.9357e-04],
         ...,
         [ 1.6278e-04, -1.8750e-04,  1.8431e-04,  ...,  6.1756e-04,
           8.6650e-04, -6.0776e-04],
         [ 3.9897e-04,  8.1855e-05,  8.3923e-06,  ...,  1.0353e-03,
           1.0493e-03, -9.7238e-04],
         [ 3.4725e-04,  1.4456e-04,  1.5660e-05,  ...,  7.1863e-04,
           9.8999e-04, -7.4479e-04]]], device='cuda:0')
tensor([[[-2.1854e-02,  1.1191e-01,  4.8708e-02,  ...,  2.3787e-02,
          -3.3933e-02, -5.4236e-02],
         [ 1.1714e-04, -1.9720e-04, -5.3866e-05,  ...,  6.1653e-05,
           6.2466e-04, -8.8827e-04],
         [ 1.1956e-04, -1.1031e-04, -3.7595e-05,  ..., -2.1895e-04,
           6.5779e-04, -8.9021e-04],
         ...,
         [-1.5581e-05, -3.8532e-04,  7.6387e-05,  ..., -3.1070e-04,
           9.7220e-04, -5.6719e-04],
         [ 3.6657e-05, -2.7682e-04, -4.6931e-05,  ..., -2.4945e-04,
           4.9171e-04, -7.3308e-04],
         [ 8.7400e-05, -1.6540e-04,  2.2227e-05,  ..., -3.2855e-05,
           7.2135e-04, -7.3817e-04]]], device='cuda:0')
tensor([[[ 2.0072e-02,  6.3208e-02,  3.4232e-02,  ...,  4.7679e-03,
          -7.5827e-03, -4.0116e-02],
         [ 1.3069e-04, -1.2511e-04, -8.9188e-06,  ...,  1.1923e-05,
           2.0123e-05, -3.5257e-04],
         [-1.4427e-04,  1.1989e-04, -3.7493e-06,  ..., -1.8892e-04,
          -2.0616e-05, -2.9218e-04],
         ...,
         [ 5.7492e-05, -1.9046e-04, -5.2274e-05,  ..., -2.3040e-04,
           1.4570e-05, -2.7297e-04],
         [ 1.2505e-04, -3.3038e-04, -1.5867e-04,  ..., -1.8631e-04,
           7.3500e-05, -2.0822e-04],
         [ 2.2957e-05, -4.9260e-04, -2.1322e-04,  ..., -2.7917e-04,
