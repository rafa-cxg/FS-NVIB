
| distributed init (rank 0): env://
Namespace(batch_size=1, num_classes=1000, epochs=100, fp16=False, output_dir='outputs/original_diet_small_lr1e-4', device='cuda', seed=0, data_path='/datasets01/imagenet_full_size/061417/', pretrained_checkpoint_path='.', dataset='cifar_fs', nClsEpisode=5, nSupport=5, nQuery=15, nValEpisode=120, nEpisode=2000, image_size=128, base_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], val_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], test_sources=['traffic_sign', 'mscoco', 'ilsvrc_2012', 'omniglot', 'aircraft', 'cu_birds', 'dtd', 'quickdraw', 'fungi', 'vgg_flower'], shuffle=True, train_transforms=['random_resized_crop', 'jitter', 'random_flip', 'to_tensor', 'normalize'], test_transforms=['resize', 'center_crop', 'to_tensor', 'normalize'], num_ways=None, num_support=None, num_query=None, min_ways=5, max_ways_upper_bound=50, max_num_query=10, max_support_set_size=500, max_support_size_contrib_per_class=100, min_examples_in_class=0, min_log_weight=-0.6931471805599453, max_log_weight=0.6931471805599453, ignore_bilevel_ontology=False, ignore_dag_ontology=False, ignore_hierarchy_probability=0.0, test_n_way=5, n_shot=5, cdfsl_domains=['EuroSAT', 'ISIC', 'CropDisease', 'ChestX'], arch='deit_small_patch16', patch_size=16, pretrained_weights='', checkpoint_key='teacher', unused_params=False, no_pretrain=True, deploy='vanilla', num_adapters=1, ada_steps=40, ada_lr=0.05, aug_prob=0.9, aug_types=['color', 'translation'], img_size=224, drop=0.0, drop_path=0.1, model_ema=False, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', lr=1e-05, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=1e-06, min_lr=1e-06, decay_epochs=30, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, color_jitter=0.4, aa='rand-m9-mstd0.5-inc1', smoothing=0.0, train_interpolation='bicubic', repeated_aug=False, reprob=0.25, remode='pixel', recount=1, resplit=False, mixup=0.0, cutmix=0.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', teacher_model='regnety_160', teacher_path='', distillation_type='none', distillation_alpha=0.5, distillation_tau=1.0, resume='', start_epoch=0, eval=False, dist_eval=True, num_workers=10, pin_mem=True, world_size=1, dist_url='env://', nvib=True, delta=1.0, alpha_tau=-8.0, stdev_tau=0.0, lambda_klg=0.0, lambda_kld=0.0, nvib_layers=[0, 1, 2, 3, 4, 5], rank=0, gpu=0, distributed=True, dist_backend='nccl')
Creating model: ProtoNet deit_small_patch16
Using NVIB Vision Transformer
Layer 0 has nvib_layer
Layer 1 has nvib_layer
Layer 2 has nvib_layer
Layer 3 has nvib_layer
Layer 4 has nvib_layer
Layer 5 has nvib_layer
number of params: 23444360
Start training for 100 epochs
tensor([[[-2.4806e-02, -1.5955e-01, -1.8162e-03,  ..., -2.1609e-01,
          -5.4225e-02, -3.2001e-02],
         [-6.8014e-05,  3.0463e-04, -1.3421e-04,  ..., -5.9066e-04,
          -4.4645e-04, -3.4568e-04],
         [-3.3933e-05,  3.2237e-04, -2.9926e-04,  ..., -4.4287e-04,
          -4.6050e-04, -2.5916e-04],
         ...,
         [-2.2596e-04,  1.2897e-04, -2.4483e-04,  ..., -6.2178e-04,
          -5.3742e-04, -2.0041e-04],
         [-1.9407e-04,  1.5444e-04, -1.7459e-04,  ..., -3.9661e-04,
          -5.4077e-04, -2.6029e-04],
         [-1.6434e-04,  1.7388e-04, -2.2385e-04,  ..., -4.7205e-04,
          -4.8538e-04, -1.3661e-04]]], device='cuda:0')
Epoch: [0]  [   0/2000]  eta: 8:54:12  lr: 0.000001  n_ways: 5  n_imgs: 100  loss: 2.5576 (2.5576)  time: 16.0263  data: 1.5106  max mem: 8273
tensor([[[-4.7314e-03, -1.3748e-02,  2.6457e-02,  ..., -4.8236e-02,
          -2.4968e-02, -5.7266e-02],
         [ 2.4076e-05,  2.7976e-04,  3.7263e-05,  ...,  3.6343e-04,
           6.1510e-05, -5.0872e-04],
         [ 1.2459e-04,  3.2342e-04,  4.3994e-05,  ...,  3.5076e-04,
          -7.1236e-05, -5.6949e-04],
         ...,
         [ 1.8622e-04,  2.7568e-04,  2.4268e-04,  ..., -1.2974e-05,
          -1.2226e-04, -4.8869e-04],
         [ 1.7185e-04,  2.8974e-04,  2.0769e-04,  ...,  1.5260e-04,
           1.8293e-04, -5.1980e-04],
         [ 8.9863e-05,  3.2958e-04,  1.8787e-04,  ...,  2.6521e-04,
           1.4280e-04, -3.6962e-04]]], device='cuda:0')
tensor([[[ 4.7606e-03,  2.1363e-01,  6.5246e-02,  ..., -6.7811e-03,
          -3.2737e-02, -1.9066e-01],
         [ 1.8429e-04,  9.3671e-05, -1.2258e-04,  ...,  7.9746e-04,
          -5.8522e-04, -3.0199e-04],
         [ 1.4234e-04,  9.8925e-05, -2.0499e-04,  ...,  1.0083e-03,
          -4.7456e-04, -1.0348e-04],
         ...,
         [-2.3608e-04,  2.6577e-04,  3.5220e-05,  ..., -5.6455e-04,
          -1.8519e-03, -4.0911e-04],
         [ 3.0061e-05,  7.9806e-05, -2.8592e-04,  ..., -2.0047e-04,
          -1.1701e-03, -5.4430e-04],
         [-1.3489e-04, -2.8238e-05, -2.6001e-04,  ..., -2.4717e-04,
          -1.0890e-03, -7.4451e-04]]], device='cuda:0')
tensor([[[-2.3793e-02, -2.0070e-02,  3.7562e-03,  ..., -4.6903e-02,
          -5.3056e-02,  2.4389e-02],
         [-1.9094e-04,  2.2538e-04,  1.0645e-04,  ..., -7.2056e-04,
          -3.3764e-04, -5.3100e-04],
         [-1.9340e-04,  1.2093e-04,  8.1843e-05,  ..., -7.0784e-04,
          -6.1386e-04, -5.4810e-04],
         ...,
         [-9.3289e-05,  2.1063e-04,  5.0357e-05,  ..., -2.9926e-04,
          -5.2468e-04, -1.7565e-04],
         [-8.6739e-05,  2.6448e-04,  6.3067e-05,  ..., -2.8253e-04,
          -5.7660e-04, -2.0941e-04],
         [-3.7574e-05,  4.0113e-04,  2.8888e-05,  ..., -2.5450e-04,
          -5.3335e-04, -2.1145e-04]]], device='cuda:0')
tensor([[[ 5.5664e-02,  2.4875e-01,  1.1776e-01,  ..., -5.9112e-02,
           7.9275e-02, -1.4437e-01],
         [ 2.6175e-05,  4.1143e-04, -9.0867e-05,  ...,  3.7370e-04,
          -2.7402e-04, -5.9780e-04],
         [-1.8675e-05,  4.7079e-04, -7.7887e-05,  ...,  8.1208e-04,
           3.2742e-04, -8.8326e-04],
         ...,
         [ 2.2941e-04,  4.6676e-04, -2.8251e-04,  ...,  8.2943e-04,
           4.8785e-04, -9.0378e-04],
         [ 2.9676e-04,  6.1350e-04, -2.3266e-04,  ...,  8.3533e-04,
           1.1984e-04, -9.1251e-04],
         [ 8.8792e-05,  4.8272e-04, -1.9938e-04,  ...,  3.6942e-04,
          -1.8101e-05, -9.0942e-04]]], device='cuda:0')
tensor([[[-1.9775e-02,  2.3888e-02,  3.3276e-02,  ..., -6.9003e-02,
          -9.9120e-02, -8.3589e-02],
         [ 2.0247e-04,  3.1454e-04,  5.2748e-05,  ...,  1.7867e-04,
           6.0647e-05, -7.2021e-04],
         [ 1.2605e-04,  3.8997e-04,  1.1769e-04,  ...,  3.1188e-04,
          -1.6201e-04, -9.2237e-04],
         ...,
         [ 1.7158e-04,  3.6146e-04, -6.8662e-05,  ...,  2.5653e-04,
          -5.0708e-04, -8.0306e-04],
         [ 8.5474e-05,  4.1822e-04, -4.7203e-05,  ...,  9.7827e-05,
          -6.4942e-04, -6.5224e-04],
         [ 6.3212e-05,  4.2410e-04, -7.6531e-05,  ...,  5.9152e-05,
          -7.9797e-04, -6.8643e-04]]], device='cuda:0')
tensor([[[-1.9208e-02,  1.1498e-01,  7.9138e-02,  ..., -8.9154e-02,
          -9.9660e-02, -1.1903e-01],
         [ 1.1395e-04,  8.8644e-05, -1.7844e-05,  ..., -5.2465e-05,
           3.2869e-05, -5.8832e-04],
         [ 1.3638e-04,  1.1421e-04, -9.8910e-05,  ...,  1.6016e-04,
          -1.8053e-04, -5.9793e-04],
         ...,
         [ 1.3887e-04,  5.0916e-04,  1.8991e-05,  ...,  2.4306e-04,
           3.2147e-05, -7.6076e-04],
         [ 5.3609e-05,  4.0028e-04, -1.1601e-05,  ..., -1.5432e-05,
           1.5051e-04, -6.4917e-04],
         [ 1.9232e-04,  4.5628e-04,  1.6797e-04,  ...,  2.4282e-05,
           2.2915e-04, -5.7834e-04]]], device='cuda:0')
tensor([[[-4.2178e-02,  6.7544e-02,  6.4941e-02,  ...,  9.9354e-02,
           4.5298e-02,  1.2760e-03],
         [ 4.0660e-04, -4.0622e-04,  3.4339e-04,  ...,  5.0812e-04,
           1.1998e-03, -9.3176e-04],
         [ 2.3590e-04, -3.4802e-04,  2.0815e-04,  ...,  7.4286e-04,
           1.3597e-03, -7.9359e-04],
         ...,
         [ 1.6282e-04, -1.8751e-04,  1.8434e-04,  ...,  6.1763e-04,
           8.6661e-04, -6.0776e-04],
         [ 3.9900e-04,  8.1881e-05,  8.3499e-06,  ...,  1.0355e-03,
           1.0493e-03, -9.7227e-04],
         [ 3.4731e-04,  1.4456e-04,  1.5653e-05,  ...,  7.1875e-04,
           9.9001e-04, -7.4482e-04]]], device='cuda:0')
tensor([[[-2.1853e-02,  1.1191e-01,  4.8707e-02,  ...,  2.3786e-02,
          -3.3937e-02, -5.4239e-02],
         [ 1.1714e-04, -1.9723e-04, -5.3919e-05,  ...,  6.1580e-05,
           6.2461e-04, -8.8821e-04],
         [ 1.1955e-04, -1.1030e-04, -3.7576e-05,  ..., -2.1897e-04,
           6.5775e-04, -8.9016e-04],
         ...,
         [-1.5603e-05, -3.8540e-04,  7.6428e-05,  ..., -3.1088e-04,
           9.7231e-04, -5.6716e-04],
         [ 3.6620e-05, -2.7685e-04, -4.6951e-05,  ..., -2.4948e-04,
           4.9159e-04, -7.3310e-04],
         [ 8.7426e-05, -1.6540e-04,  2.2215e-05,  ..., -3.2824e-05,
           7.2144e-04, -7.3807e-04]]], device='cuda:0')
tensor([[[ 2.0072e-02,  6.3209e-02,  3.4232e-02,  ...,  4.7735e-03,
          -7.5861e-03, -4.0118e-02],
         [ 1.3068e-04, -1.2516e-04, -8.9303e-06,  ...,  1.1939e-05,
           2.0170e-05, -3.5252e-04],
         [-1.4439e-04,  1.1978e-04, -3.7721e-06,  ..., -1.8905e-04,
          -2.0618e-05, -2.9205e-04],
         ...,
         [ 5.7546e-05, -1.9040e-04, -5.2209e-05,  ..., -2.3029e-04,
           1.4466e-05, -2.7298e-04],
         [ 1.2503e-04, -3.3037e-04, -1.5862e-04,  ..., -1.8621e-04,
           7.3526e-05, -2.0823e-04],
         [ 2.2986e-05, -4.9259e-04, -2.1319e-04,  ..., -2.7919e-04,
          -2.6066e-04, -3.7928e-04]]], device='cuda:0')
tensor([[[ 9.8487e-03,  2.1072e-01,  1.6034e-01,  ..., -3.5817e-02,
          -4.3857e-02, -2.0708e-01],
         [ 1.2807e-04, -3.0894e-04,  2.0037e-04,  ...,  7.7605e-04,
           4.3294e-04, -8.3352e-04],
         [ 1.2510e-04, -2.2371e-04,  6.0160e-05,  ...,  7.1931e-04,
           4.7307e-04, -9.3083e-04],
         ...,
         [ 4.3985e-05, -3.6400e-04, -1.1092e-04,  ...,  8.9025e-05,
           8.8365e-04, -1.1171e-03],
         [-1.7621e-04, -1.6815e-04, -4.9660e-05,  ...,  1.3323e-04,
           5.9946e-04, -8.9911e-04],
         [-7.2830e-05, -5.2508e-04, -8.6586e-05,  ..., -1.7502e-04,
           5.8534e-04, -8.6581e-04]]], device='cuda:0')
Epoch: [0]  [  10/2000]  eta: 1:06:15  lr: 0.000001  n_ways: 5  n_imgs: 100  loss: 3.1733 (3.0008)  time: 1.9976  data: 0.1375  max mem: 8395
tensor([[[-2.2659e-02, -1.1503e-02,  2.9138e-03,  ..., -2.1027e-02,
          -7.9983e-02, -1.2549e-01],
         [-1.1081e-05,  5.0097e-05, -1.7080e-04,  ..., -1.1047e-04,
           3.4155e-04, -6.2325e-04],
         [-1.6953e-04,  2.2685e-04, -4.9308e-04,  ..., -3.0828e-04,
           3.7611e-04, -5.2221e-04],
         ...,
         [-3.3748e-04, -4.2719e-04, -4.1805e-04,  ..., -1.0137e-03,
          -7.3580e-05, -4.5184e-04],
         [-2.0863e-04, -3.6607e-04, -3.5002e-04,  ..., -8.2869e-04,
          -1.4911e-04, -3.6842e-04],
         [-3.9461e-04, -3.4986e-04, -4.8552e-04,  ..., -8.9789e-04,
          -3.1448e-05, -4.5512e-04]]], device='cuda:0')
tensor([[[-6.9621e-03,  5.9218e-02,  5.1310e-02,  ...,  1.3235e-02,
          -2.9576e-02, -1.0558e-01],
         [-1.1310e-04, -5.3390e-06, -1.3068e-04,  ..., -2.5667e-04,
           2.3853e-04, -4.1926e-04],
         [-1.7193e-04,  6.4690e-05, -1.5273e-04,  ..., -1.9135e-04,
           2.8927e-04, -3.7270e-04],
         ...,
         [ 1.9628e-05, -4.4291e-05,  1.1271e-04,  ..., -2.1906e-04,
          -3.7575e-04, -3.3631e-04],
         [ 1.0336e-05, -3.9669e-05,  1.1069e-04,  ..., -2.9475e-04,
          -2.9830e-04, -3.8232e-04],
         [-2.4412e-04, -1.8525e-04,  1.5035e-04,  ..., -5.9432e-04,
          -2.9719e-04, -4.4757e-04]]], device='cuda:0')
tensor([[[-3.0678e-03,  9.6601e-02,  6.0894e-02,  ...,  1.5868e-03,
           1.0276e-02, -2.4135e-02],
         [ 2.1697e-04, -4.5962e-05,  1.1113e-04,  ..., -4.0239e-05,
          -2.8276e-04, -6.3769e-04],
         [ 1.3485e-04, -5.4467e-05, -5.6301e-05,  ..., -3.5857e-05,
          -3.1121e-04, -5.9651e-04],
         ...,
         [-1.5593e-04, -3.9716e-04, -4.8351e-04,  ...,  2.1514e-05,
           6.1331e-04, -1.1420e-03],
         [ 1.3607e-04, -3.5281e-05, -7.4586e-05,  ...,  2.1823e-04,
           6.1655e-04, -7.7569e-04],
         [ 2.0576e-04, -4.7242e-05, -4.6161e-05,  ...,  2.6352e-04,
           4.0434e-04, -8.2580e-04]]], device='cuda:0')
tensor([[[ 7.9950e-03,  9.0901e-02,  3.1709e-02,  ..., -7.3629e-02,
          -5.7136e-02, -1.2573e-01],
         [ 4.6108e-05,  3.2174e-04, -2.1194e-04,  ..., -2.0940e-04,
          -5.6777e-04, -1.0470e-03],
         [-6.1772e-06,  3.7319e-04, -1.8607e-04,  ..., -3.0510e-04,
          -6.7682e-04, -1.0751e-03],
         ...,
         [ 1.2290e-04,  5.3272e-04, -1.0363e-04,  ..., -4.8279e-05,
          -5.6790e-04, -1.1430e-03],
         [ 1.1411e-04,  5.5809e-04, -1.0244e-04,  ..., -2.5760e-04,
          -6.7404e-04, -1.2196e-03],
         [ 1.6392e-04,  6.7419e-04, -1.5578e-04,  ...,  2.2751e-05,
          -4.6602e-04, -1.3090e-03]]], device='cuda:0')
tensor([[[-4.7262e-03,  1.3680e-01,  6.8927e-02,  ..., -3.2835e-03,
          -1.3193e-01, -1.8215e-01],
         [-1.4965e-05,  5.9730e-04, -1.9640e-04,  ..., -2.3675e-04,
          -6.4747e-04, -8.7421e-04],
         [-5.1169e-05,  5.8119e-04, -2.3107e-04,  ..., -1.9931e-04,
          -5.8378e-04, -8.7663e-04],
         ...,
         [ 6.1885e-05,  8.2092e-04, -2.0829e-05,  ..., -1.0126e-03,
          -1.4112e-03, -1.1765e-03],
         [ 9.5105e-06,  6.5214e-04, -1.0791e-05,  ..., -6.9582e-04,
          -1.1697e-03, -1.0224e-03],
         [ 5.2029e-05,  7.0079e-04, -6.7250e-05,  ..., -4.2627e-04,
          -1.1486e-03, -1.2093e-03]]], device='cuda:0')
tensor([[[ 5.2734e-04, -3.1395e-02,  2.5343e-02,  ..., -3.6953e-02,
          -4.8760e-03, -4.6166e-02],
         [-1.0720e-04, -9.2305e-05, -4.4158e-04,  ..., -6.5853e-04,
          -2.5623e-04, -3.1989e-05],
         [ 1.0891e-04, -3.8407e-04, -2.3799e-04,  ..., -5.0948e-04,
           3.9699e-04, -1.3678e-04],
         ...,
         [ 7.2328e-05,  1.1036e-04, -1.8061e-04,  ..., -1.9970e-04,
          -4.8582e-04, -1.4825e-04],
         [ 3.8987e-05,  1.0065e-04, -1.4012e-04,  ..., -2.5013e-04,
          -4.3125e-04, -1.2041e-04],
         [-2.0501e-05,  8.9077e-06, -1.5598e-04,  ..., -2.7517e-04,
          -5.1437e-04, -3.4052e-05]]], device='cuda:0')
tensor([[[-1.7652e-02,  3.8569e-02,  2.3539e-02,  ..., -5.3067e-02,
          -7.7197e-02, -8.9473e-02],
         [-2.2552e-05,  2.6746e-04, -6.0964e-05,  ..., -7.9527e-06,
          -8.3188e-04, -3.8207e-04],
         [-1.2845e-06,  2.1277e-04, -7.3671e-05,  ...,  4.6578e-05,
          -6.9369e-04, -4.2699e-04],
         ...,
         [-1.0904e-04,  5.0873e-04, -1.8626e-04,  ..., -7.0367e-04,
          -1.3907e-03, -4.3955e-04],
         [-2.6074e-05,  4.1756e-04, -1.8529e-04,  ..., -6.5676e-04,
          -1.3709e-03, -4.0574e-04],
         [-1.0982e-04,  3.5160e-04, -6.1981e-05,  ..., -6.5775e-04,
          -1.4986e-03, -4.9594e-04]]], device='cuda:0')
tensor([[[ 4.3759e-03,  1.8059e-01,  1.0000e-01,  ..., -1.7716e-01,
          -1.2566e-01, -2.2025e-01],
         [ 3.1098e-04,  7.7736e-04, -4.6561e-04,  ...,  9.7749e-05,
           2.0968e-05, -1.0124e-03],
         [-2.3009e-05,  4.2957e-04, -4.7571e-04,  ..., -4.4028e-04,
          -3.6476e-04, -8.3047e-04],
         ...,
         [-3.8792e-05,  5.5808e-04, -7.0578e-05,  ..., -7.5853e-05,
          -9.8306e-04, -9.5337e-04],
         [-7.9302e-05,  5.5886e-04,  9.4182e-06,  ..., -2.4141e-04,
          -9.2088e-04, -8.9878e-04],
         [-5.2613e-04,  3.6557e-04, -4.1163e-04,  ..., -3.4187e-04,
          -1.3998e-03, -1.1073e-03]]], device='cuda:0')
tensor([[[-7.2225e-03,  8.4832e-02,  5.9945e-02,  ...,  2.0063e-03,
          -4.1945e-02, -7.1165e-02],
         [ 4.2035e-05,  4.7298e-04,  6.2797e-06,  ...,  2.4653e-04,
          -5.6158e-04, -6.4424e-04],
         [ 1.9645e-04,  4.6836e-04,  4.8746e-05,  ...,  3.9676e-04,
          -1.8183e-04, -7.5467e-04],
         ...,
         [ 2.2465e-04,  4.3185e-04,  1.0726e-04,  ..., -1.3835e-05,
          -1.9107e-04, -8.5766e-04],
         [ 1.5753e-04,  3.4808e-04,  1.4724e-04,  ...,  1.4317e-04,
          -6.9253e-05, -6.1566e-04],
         [ 3.6491e-04,  3.3155e-04,  3.6423e-04,  ...,  6.1126e-04,
          -3.7067e-04, -5.3707e-04]]], device='cuda:0')
tensor([[[-1.7963e-02,  2.3862e-02,  7.6188e-03,  ..., -4.2454e-03,
          -4.5703e-02, -1.4720e-02],
         [ 3.7170e-05, -9.8924e-05, -2.1040e-04,  ..., -3.4390e-04,
           2.2363e-04, -4.0839e-04],
         [ 7.0867e-05, -1.0955e-04,  4.5336e-05,  ..., -3.8406e-05,
           3.4912e-04, -5.2851e-04],
         ...,
         [-7.5070e-05, -3.0945e-05, -1.6646e-04,  ..., -4.9921e-04,
          -7.2300e-04, -2.8625e-04],
         [-8.1785e-05, -7.4163e-05, -1.1598e-04,  ..., -3.3472e-04,
          -6.4602e-04, -1.6853e-04],
         [-1.8402e-04, -3.0695e-04, -9.4269e-05,  ..., -4.1169e-04,
          -6.0038e-04, -1.7393e-04]]], device='cuda:0')
Epoch: [0]  [  20/2000]  eta: 0:43:41  lr: 0.000001  n_ways: 5  n_imgs: 100  loss: 3.0165 (2.9961)  time: 0.5888  data: 0.0002  max mem: 8395
tensor([[[-2.0140e-02,  4.9587e-02,  5.1912e-02,  ..., -9.6775e-02,
          -2.0489e-02, -6.9311e-02],
         [ 1.0911e-04,  7.6293e-05,  7.1081e-05,  ...,  1.1249e-04,
           3.6383e-04, -9.2467e-04],
         [ 1.5127e-04,  1.0815e-04,  6.1690e-05,  ...,  1.7638e-04,
           5.9576e-04, -1.0921e-03],
         ...,
         [ 2.6867e-04,  8.2844e-05,  9.5637e-05,  ...,  4.8938e-04,
           5.7660e-04, -9.4267e-04],
         [ 1.8727e-04,  2.4899e-04,  6.6976e-05,  ...,  5.2401e-04,
           6.2486e-04, -1.0044e-03],
         [ 1.3222e-04,  9.5038e-05,  1.4153e-04,  ...,  4.2843e-04,
           4.2747e-04, -8.1109e-04]]], device='cuda:0')
tensor([[[-4.7763e-03,  3.7840e-02,  1.3677e-02,  ..., -2.5684e-02,
          -3.4811e-02, -3.6296e-02],
         [-1.5542e-04, -2.0877e-04, -1.0430e-04,  ..., -2.3794e-04,
           2.7025e-04, -1.8491e-04],
         [-8.3919e-05,  1.2531e-04, -9.8271e-05,  ..., -2.4290e-05,
           1.1068e-04, -4.1411e-04],
         ...,
         [ 1.2593e-04,  2.7488e-04,  8.7031e-05,  ..., -1.8468e-04,
          -4.2307e-04, -3.0668e-04],
         [ 3.3688e-05,  1.8973e-04,  4.4823e-05,  ..., -1.5316e-04,
          -2.4358e-04, -2.9388e-04],
         [-4.8600e-05,  1.1214e-04, -9.3396e-06,  ..., -1.1203e-04,
          -2.2846e-04, -2.8574e-04]]], device='cuda:0')
tensor([[[-5.3371e-02,  9.4019e-02,  9.1299e-02,  ...,  4.9720e-02,
          -5.6155e-02, -1.2143e-01],
         [-1.6016e-05,  3.1472e-04, -1.8260e-04,  ..., -1.0475e-04,
          -8.8579e-04, -4.4517e-04],
         [-1.1804e-04,  4.1287e-04, -2.3385e-04,  ..., -6.3514e-05,
          -9.1184e-04, -5.0613e-04],
         ...,
         [ 3.3098e-04,  6.5584e-04, -1.0748e-04,  ..., -8.8995e-05,
          -8.5076e-04, -4.0952e-04],
         [ 1.9160e-04,  8.0050e-04, -1.3940e-04,  ...,  1.1963e-04,
          -7.2994e-04, -6.6335e-04],
         [ 1.3277e-04,  5.3737e-04, -7.4924e-05,  ...,  5.7484e-05,
          -1.0257e-03, -6.9272e-04]]], device='cuda:0')
tensor([[[-1.3768e-02,  2.3234e-02,  4.8459e-03,  ..., -9.0412e-02,
          -9.5413e-02, -9.6158e-02],
         [ 3.7974e-04,  4.5095e-04, -1.6351e-04,  ...,  6.7710e-04,
           9.7317e-05, -8.1540e-04],
         [ 2.2676e-04,  3.4829e-04, -1.3154e-04,  ...,  4.1360e-04,
          -6.3454e-05, -7.0467e-04],
         ...,
         [ 1.1541e-04,  3.6813e-04, -3.0002e-04,  ...,  2.2092e-04,
           7.9144e-07, -7.7247e-04],
         [ 1.4981e-04,  3.4316e-04, -1.8714e-04,  ...,  2.6165e-04,
          -9.7705e-05, -8.4925e-04],
         [ 1.5041e-04,  4.1338e-04, -1.8158e-04,  ...,  4.1844e-04,
          -1.0021e-04, -8.4263e-04]]], device='cuda:0')
tensor([[[-8.1878e-03,  1.0475e-01,  3.0395e-02,  ..., -2.9797e-02,
          -1.2379e-02, -9.4576e-02],
         [ 2.7956e-04,  7.6241e-04, -8.8568e-05,  ...,  2.2766e-04,
           6.5006e-05, -6.6932e-04],
         [ 2.4910e-04,  6.1784e-04, -7.0916e-05,  ...,  2.9764e-04,
           2.7927e-04, -6.6908e-04],
         ...,
         [ 1.7170e-04,  6.2972e-04,  1.0075e-04,  ..., -6.3682e-04,
          -4.6363e-04, -7.8532e-04],
         [ 2.7102e-04,  7.2319e-04,  1.2044e-04,  ..., -6.1281e-04,
          -1.8688e-04, -7.9497e-04],
         [ 1.9576e-04,  7.7813e-04,  7.6695e-05,  ..., -5.9665e-04,
          -2.9750e-04, -6.8755e-04]]], device='cuda:0')
tensor([[[ 6.3027e-03,  4.7122e-02,  3.2553e-02,  ...,  1.7245e-02,
           6.7443e-03, -7.0332e-02],
         [ 4.1012e-04,  1.0592e-04,  3.3092e-04,  ...,  2.6948e-05,
           7.9142e-04, -6.0962e-04],
         [ 3.2179e-04, -1.9763e-05,  4.2892e-04,  ..., -4.6690e-05,
           6.7052e-04, -5.3828e-04],
         ...,
         [ 2.5139e-04,  9.6521e-05, -1.5678e-04,  ...,  1.5739e-04,
           5.4689e-04, -3.7973e-04],
         [ 2.0319e-04, -1.3764e-05,  8.1547e-05,  ...,  5.0096e-05,
           4.6052e-04, -4.8387e-04],
         [ 2.0640e-04,  1.4416e-05,  7.7866e-05,  ...,  7.8192e-05,
           4.8706e-05, -4.5297e-04]]], device='cuda:0')
tensor([[[-6.6301e-03,  1.0290e-01,  1.0764e-01,  ..., -2.3468e-02,
          -1.2861e-02, -1.0075e-01],
         [ 1.5320e-04,  3.2945e-04, -1.7850e-04,  ...,  4.1249e-04,
           1.2250e-03, -1.0256e-03],
         [ 7.6079e-05,  2.6051e-04, -1.1943e-04,  ...,  5.1996e-04,
           9.2403e-04, -8.4707e-04],
         ...,
         [ 7.2104e-05, -2.5069e-05,  5.1163e-05,  ...,  4.5783e-04,
           5.3535e-04, -5.5345e-04],
         [ 1.1973e-04,  9.5970e-05,  4.7171e-05,  ...,  4.6477e-04,
           4.5932e-04, -5.4226e-04],
         [ 1.2882e-04,  2.6379e-04,  2.4140e-05,  ...,  5.6609e-04,
           3.9826e-04, -5.6018e-04]]], device='cuda:0')
tensor([[[ 1.1323e-02, -4.4813e-02, -1.1270e-02,  ..., -1.2211e-01,
          -2.8297e-02, -6.6352e-02],
         [ 1.9024e-04,  2.9784e-04, -8.8497e-05,  ...,  1.3576e-05,
          -3.1738e-04, -7.6581e-05],
         [ 2.3301e-04,  2.3425e-04, -5.5506e-05,  ..., -3.3897e-05,
          -2.2147e-04, -1.8035e-04],
         ...,
         [ 3.6933e-04,  3.1565e-04,  4.5949e-05,  ..., -4.1135e-05,
          -7.6132e-04, -3.6587e-04],
         [ 4.3261e-04,  4.7284e-04,  1.1425e-04,  ...,  1.6329e-04,
          -9.5204e-04, -1.1587e-04],
         [ 2.7404e-04,  3.8011e-04, -6.6605e-05,  ..., -6.6638e-05,
          -7.4352e-04, -1.1560e-04]]], device='cuda:0')
tensor([[[-1.5747e-03,  4.1601e-02,  8.7583e-03,  ..., -7.9394e-02,
          -7.8405e-02, -1.1472e-01],
         [-3.9530e-05,  2.9770e-04, -1.2902e-04,  ...,  1.5229e-04,
          -4.7988e-04, -3.6077e-04],
         [-5.4184e-05,  1.6602e-04, -8.0429e-05,  ..., -1.3407e-05,
          -4.6395e-04, -2.9520e-04],
         ...,
         [ 5.1552e-05,  4.8888e-04, -9.9976e-05,  ...,  1.2077e-04,
          -6.9089e-04, -4.5135e-04],
         [ 1.0578e-04,  4.4652e-04, -5.1593e-05,  ...,  2.1064e-04,
          -4.2532e-04, -4.6272e-04],
         [ 6.7124e-05,  3.5953e-04, -5.7892e-06,  ...,  2.0311e-04,
          -2.3452e-04, -4.1940e-04]]], device='cuda:0')
tensor([[[-4.3211e-05,  6.3728e-03,  1.3148e-02,  ..., -1.0327e-01,
          -6.5953e-02, -1.1356e-01],
         [ 2.5084e-05,  4.1644e-04, -3.4442e-04,  ..., -3.5190e-04,
          -7.3610e-04, -7.9685e-04],
         [-1.9485e-05,  5.3051e-04, -3.0447e-04,  ..., -4.8814e-04,
          -1.0913e-03, -9.4852e-04],
         ...,
         [ 7.6545e-05,  3.5367e-04, -1.1773e-04,  ..., -7.7694e-05,
          -2.4310e-04, -7.1669e-04],
         [ 1.2566e-04,  2.0717e-04, -8.6898e-05,  ...,  4.3939e-05,
          -2.6962e-04, -7.2895e-04],
         [ 8.5012e-05,  2.9495e-04, -2.2016e-04,  ..., -6.9509e-05,
          -5.1805e-04, -7.9132e-04]]], device='cuda:0')
Epoch: [0]  [  30/2000]  eta: 0:35:36  lr: 0.000001  n_ways: 5  n_imgs: 100  loss: 2.9056 (2.9567)  time: 0.5823  data: 0.0002  max mem: 8395
tensor([[[-2.9417e-03,  9.4887e-02,  8.8517e-02,  ..., -1.3580e-01,
           2.8587e-02, -6.5866e-02],
         [ 1.3662e-04,  4.5119e-05,  1.8493e-04,  ...,  5.0256e-04,
           3.3031e-04, -3.0790e-04],
         [ 2.6101e-04,  2.2934e-04,  1.3159e-04,  ...,  4.6520e-04,
           3.3263e-04, -4.2002e-04],
         ...,
         [ 7.4751e-05,  2.4921e-04, -8.6469e-05,  ...,  4.8037e-04,
           5.4862e-04, -3.7688e-04],
         [ 1.2081e-04,  9.0384e-05,  1.7385e-07,  ...,  5.6159e-04,
           6.2682e-04, -3.2236e-04],
         [ 3.3965e-04,  6.6266e-04, -1.1804e-04,  ...,  2.4961e-04,
          -2.1566e-04, -6.4659e-04]]], device='cuda:0')
tensor([[[ 1.9960e-03,  5.1683e-02,  5.0767e-02,  ..., -2.8471e-02,
          -4.4689e-02, -1.0721e-01],
         [ 6.5132e-05,  1.0587e-05, -1.2246e-04,  ..., -8.6799e-05,
          -3.2093e-04, -7.8799e-04],
         [ 8.9813e-05,  5.5557e-05, -1.2988e-04,  ..., -1.0020e-04,
           7.3289e-05, -7.9131e-04],
         ...,
         [-3.5187e-04, -3.0323e-04, -1.7373e-04,  ..., -3.2115e-04,
           2.3734e-04, -7.4077e-04],
         [-2.1103e-04, -1.3089e-04, -2.4777e-04,  ..., -2.5882e-04,
           2.6440e-04, -8.9522e-04],
         [-9.2483e-05,  1.0393e-05, -2.4594e-04,  ..., -2.3596e-04,
           3.8082e-04, -1.0383e-03]]], device='cuda:0')
tensor([[[ 8.7212e-04,  8.4546e-02,  2.8960e-02,  ..., -4.4367e-02,
          -5.8003e-02, -1.1022e-01],
         [ 8.4599e-05,  3.8012e-04, -9.2563e-05,  ...,  5.8373e-04,
          -2.7958e-05, -7.4276e-04],
         [ 7.2769e-05,  4.2361e-04, -2.0234e-05,  ...,  6.8594e-04,
           2.0279e-04, -8.8571e-04],
         ...,
         [-3.5645e-05,  2.0862e-04, -4.5349e-06,  ...,  2.1250e-04,
          -1.1874e-04, -7.2734e-04],
         [ 5.9259e-05,  3.0983e-04,  1.7749e-05,  ...,  2.9304e-04,
          -7.5576e-05, -7.4274e-04],
         [ 9.5844e-06,  1.6944e-04, -5.9041e-06,  ...,  1.8420e-04,
          -3.0358e-04, -6.9169e-04]]], device='cuda:0')
tensor([[[ 1.1310e-02,  1.2459e-02,  8.1998e-03,  ...,  1.6980e-04,
          -3.5862e-02, -8.1636e-02],
         [ 4.6062e-05,  6.9607e-05, -2.2883e-04,  ..., -7.3672e-04,
          -3.5612e-04, -1.3973e-04],
         [-3.8346e-06, -4.0300e-05, -2.4878e-04,  ..., -6.6812e-04,
          -2.3077e-04, -8.3179e-05],
         ...,
         [-2.2793e-05, -3.8559e-05, -9.6147e-05,  ..., -4.0684e-04,
          -2.4785e-04, -4.1340e-04],
         [ 7.4815e-05,  1.6954e-04,  3.3024e-05,  ..., -3.8141e-04,
          -1.3858e-04, -3.1064e-04],
         [ 6.7814e-05,  1.4445e-04, -1.6154e-04,  ..., -5.0994e-04,
          -7.6489e-05, -1.1766e-04]]], device='cuda:0')
tensor([[[ 4.8495e-02,  2.0987e-01,  7.2696e-02,  ..., -6.8035e-02,
          -4.8265e-02, -1.7276e-01],
         [ 1.7414e-04,  1.4019e-04,  2.0104e-04,  ...,  1.1608e-03,
           2.5622e-05, -9.7900e-04],
         [ 1.9256e-04,  1.2929e-04,  2.4001e-04,  ...,  8.3158e-04,
          -4.0636e-04, -1.1354e-03],
         ...,
         [ 4.3343e-04,  1.1494e-03,  2.5192e-04,  ...,  1.0134e-03,
          -5.5971e-04, -1.1724e-03],
         [ 3.8916e-04,  9.4452e-04,  1.9148e-04,  ...,  8.3159e-04,
          -5.8820e-04, -9.3671e-04],
         [ 3.0533e-04,  9.7597e-04,  2.4767e-04,  ...,  1.0312e-03,
          -4.1906e-04, -1.0886e-03]]], device='cuda:0')
tensor([[[-6.1679e-03,  2.1755e-02, -2.0898e-02,  ..., -7.4496e-02,
          -1.4008e-01, -1.0066e-01],
         [-1.7082e-05,  2.4021e-04, -6.5353e-05,  ...,  1.7883e-04,
          -4.0795e-04, -5.2658e-04],
         [-7.4269e-05,  2.2584e-04, -1.3480e-04,  ...,  1.0543e-04,
          -2.1915e-04, -6.1430e-04],
         ...,
         [ 1.5509e-05,  1.5007e-04,  4.7900e-05,  ...,  1.7204e-04,
           1.5019e-04, -6.3645e-04],
         [ 5.3352e-05,  1.5218e-04,  1.0657e-04,  ...,  3.7167e-04,
           3.9723e-04, -6.5829e-04],
         [ 2.7183e-05,  1.6571e-04,  5.1860e-05,  ...,  4.3606e-04,
           3.4498e-04, -6.5737e-04]]], device='cuda:0')
tensor([[[-1.4952e-02,  2.8147e-02,  1.2208e-02,  ..., -2.3912e-03,
          -1.0226e-01, -1.1188e-01],
         [-1.9091e-04,  6.3951e-04, -4.5973e-04,  ..., -1.2508e-03,
          -1.4056e-03, -6.7139e-04],
         [-4.1793e-04,  4.1753e-04, -3.6554e-04,  ..., -1.2221e-03,
          -1.4685e-03, -6.4902e-04],
         ...,
         [-2.0838e-04,  6.2916e-04, -5.2481e-05,  ..., -6.3979e-04,
          -1.5911e-03, -8.0132e-04],
         [-5.1660e-05,  6.0038e-04, -1.5354e-05,  ..., -4.0355e-04,
          -1.4724e-03, -6.5927e-04],
         [-1.8703e-04,  5.5451e-04, -1.3928e-05,  ..., -3.7722e-04,
          -1.5886e-03, -7.0203e-04]]], device='cuda:0')
tensor([[[ 1.6117e-02,  5.5363e-02,  4.1340e-02,  ..., -7.2860e-02,
          -7.7506e-03, -8.7652e-02],
         [ 1.7298e-04,  9.6088e-05, -2.2516e-04,  ..., -2.1027e-04,
           3.3710e-04, -1.7826e-04],
         [ 9.7118e-05, -6.9529e-05, -2.2194e-04,  ..., -1.9799e-04,
           3.1725e-04, -1.4174e-04],
         ...,
         [ 4.1679e-04,  2.6170e-05, -1.7009e-04,  ..., -1.2673e-04,
           2.9715e-04, -4.4153e-04],
         [ 2.7102e-04,  1.3567e-04, -2.0856e-04,  ..., -2.2689e-04,
           2.9513e-04, -3.4358e-04],
         [ 2.1419e-04, -2.6859e-05, -3.5504e-04,  ..., -2.5886e-04,
