
| distributed init (rank 0): env://
Namespace(batch_size=1, num_classes=1000, epochs=100, fp16=False, output_dir='outputs/original_diet_small_lr1e-4', device='cuda', seed=0, data_path='/datasets01/imagenet_full_size/061417/', pretrained_checkpoint_path='.', dataset='cifar_fs', nClsEpisode=5, nSupport=5, nQuery=15, nValEpisode=120, nEpisode=2000, image_size=128, base_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], val_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], test_sources=['traffic_sign', 'mscoco', 'ilsvrc_2012', 'omniglot', 'aircraft', 'cu_birds', 'dtd', 'quickdraw', 'fungi', 'vgg_flower'], shuffle=True, train_transforms=['random_resized_crop', 'jitter', 'random_flip', 'to_tensor', 'normalize'], test_transforms=['resize', 'center_crop', 'to_tensor', 'normalize'], num_ways=None, num_support=None, num_query=None, min_ways=5, max_ways_upper_bound=50, max_num_query=10, max_support_set_size=500, max_support_size_contrib_per_class=100, min_examples_in_class=0, min_log_weight=-0.6931471805599453, max_log_weight=0.6931471805599453, ignore_bilevel_ontology=False, ignore_dag_ontology=False, ignore_hierarchy_probability=0.0, test_n_way=5, n_shot=5, cdfsl_domains=['EuroSAT', 'ISIC', 'CropDisease', 'ChestX'], arch='deit_small_patch16', patch_size=16, pretrained_weights='', checkpoint_key='teacher', unused_params=False, no_pretrain=False, deploy='vanilla', num_adapters=1, ada_steps=40, ada_lr=0.05, aug_prob=0.9, aug_types=['color', 'translation'], img_size=224, drop=0.0, drop_path=0.1, model_ema=False, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', lr=1e-05, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=1e-06, min_lr=1e-06, decay_epochs=30, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, color_jitter=0.4, aa='rand-m9-mstd0.5-inc1', smoothing=0.0, train_interpolation='bicubic', repeated_aug=False, reprob=0.25, remode='pixel', recount=1, resplit=False, mixup=0.0, cutmix=0.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', teacher_model='regnety_160', teacher_path='', distillation_type='none', distillation_alpha=0.5, distillation_tau=1.0, resume='', start_epoch=0, eval=False, dist_eval=True, num_workers=10, pin_mem=True, world_size=1, dist_url='env://', nvib=True, delta=1.0, alpha_tau=-8.0, stdev_tau=0.0, lambda_klg=0.0, lambda_kld=0.0, nvib_layers=[0, 1, 2, 3, 4, 5], rank=0, gpu=0, distributed=True, dist_backend='nccl')
Creating model: ProtoNet deit_small_patch16
Using NVIB Vision Transformer
Layer 0 has nvib_layer
Layer 1 has nvib_layer
Layer 2 has nvib_layer
Layer 3 has nvib_layer
Layer 4 has nvib_layer
Layer 5 has nvib_layer
removing key head.weight from pretrained checkpoint
removing key head.bias from pretrained checkpoint
Pretrained weights found at https://dl.fbaipublicfiles.com/deit/deit_small_patch16_224-cd65a155.pth
number of params: 23444360
Start training for 100 epochs
tensor([[[-2.3330e-03,  2.2075e-03, -4.7364e-03,  ...,  2.8734e-03,
           2.4960e-03, -1.2781e-03],
         [-5.4044e-04, -7.2080e-04, -2.8305e-04,  ...,  6.4847e-04,
           2.0251e-03,  1.8782e-04],
         [-9.3815e-05,  2.8668e-03, -1.1818e-04,  ..., -3.0822e-04,
          -2.7501e-03, -1.0770e-03],
         ...,
         [-7.4315e-05,  3.3606e-04, -2.1527e-04,  ...,  4.0835e-04,
           1.3784e-03,  8.3614e-04],
         [-2.2279e-04, -3.9193e-04,  8.2792e-06,  ..., -1.3659e-04,
           2.3537e-04,  6.7463e-04],
         [-3.8412e-04, -2.0655e-03,  6.1898e-05,  ..., -7.6303e-04,
          -1.3353e-03, -5.0057e-04]]], device='cuda:0')
Epoch: [0]  [   0/2000]  eta: 5:47:36  lr: 0.000001  n_ways: 5  n_imgs: 100  loss: 1.7127 (1.7127)  time: 10.4280  data: 2.0525  max mem: 8275
tensor([[[-7.4965e-03, -2.4359e-03, -3.9997e-05,  ...,  6.1155e-03,
           6.9978e-03, -6.6000e-03],
         [-1.3160e-04,  1.4199e-03,  4.6260e-04,  ..., -9.6569e-04,
          -1.0742e-03,  2.9718e-04],
         [ 1.5017e-03, -4.0306e-03, -1.1715e-03,  ...,  3.8723e-03,
           7.5091e-03,  3.5788e-04],
         ...,
         [ 1.5340e-04, -9.8384e-04, -2.3760e-04,  ..., -3.4913e-05,
           1.4989e-03, -8.7226e-05],
         [ 6.9803e-04, -3.4184e-03, -1.1262e-03,  ..., -6.2312e-04,
           1.8914e-03, -5.8908e-04],
         [ 1.2099e-03, -4.5469e-03, -7.1257e-04,  ...,  3.9588e-04,
           1.7463e-03, -1.1924e-03]]], device='cuda:0')