Not using distributed mode
Namespace(batch_size=1, num_classes=1000, epochs=100, fp16=False, output_dir='outputs/original_diet_small_lr1e-4', device='cuda:0', seed=0, data_path='/datasets01/imagenet_full_size/061417/', pretrained_checkpoint_path='.', dataset='cifar_fs', nClsEpisode=5, nSupport=5, nQuery=15, nValEpisode=120, nEpisode=2000, image_size=128, base_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], val_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], test_sources=['traffic_sign', 'mscoco', 'ilsvrc_2012', 'omniglot', 'aircraft', 'cu_birds', 'dtd', 'quickdraw', 'fungi', 'vgg_flower'], shuffle=True, train_transforms=['random_resized_crop', 'jitter', 'random_flip', 'to_tensor', 'normalize'], test_transforms=['resize', 'center_crop', 'to_tensor', 'normalize'], num_ways=None, num_support=None, num_query=None, min_ways=5, max_ways_upper_bound=50, max_num_query=10, max_support_set_size=500, max_support_size_contrib_per_class=100, min_examples_in_class=0, min_log_weight=-0.6931471805599453, max_log_weight=0.6931471805599453, ignore_bilevel_ontology=False, ignore_dag_ontology=False, ignore_hierarchy_probability=0.0, test_n_way=5, n_shot=5, cdfsl_domains=['EuroSAT', 'ISIC', 'CropDisease', 'ChestX'], arch='deit_small_patch16', patch_size=16, pretrained_weights='', checkpoint_key='teacher', unused_params=False, no_pretrain=False, deploy='vanilla', num_adapters=1, ada_steps=40, ada_lr=0.05, aug_prob=0.9, aug_types=['color', 'translation'], img_size=224, drop=0.0, drop_path=0.1, model_ema=False, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', lr=1e-06, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=1e-06, min_lr=1e-06, decay_epochs=30, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, color_jitter=0.4, aa='rand-m9-mstd0.5-inc1', smoothing=0.0, train_interpolation='bicubic', repeated_aug=False, reprob=0.25, remode='pixel', recount=1, resplit=False, mixup=0.0, cutmix=0.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', teacher_model='regnety_160', teacher_path='', distillation_type='none', distillation_alpha=0.5, distillation_tau=1.0, resume='', start_epoch=0, eval=False, dist_eval=False, num_workers=10, pin_mem=True, world_size=1, dist_url='env://', nvib=True, delta=1.0, alpha_tau=0.0, stdev_tau=0.0, lambda_klg=0.001, lambda_kld=0.001, nvib_layers=[0, 1, 2, 3, 4, 5], distributed=False)
Creating model: ProtoNet deit_small_patch16
Using NVIB Vision Transformer
Layer 0 has nvib_layer
Layer 1 has nvib_layer
Layer 2 has nvib_layer
Layer 3 has nvib_layer
Layer 4 has nvib_layer
Layer 5 has nvib_layer
removing key head.weight from pretrained checkpoint
removing key head.bias from pretrained checkpoint
Pretrained weights found at https://dl.fbaipublicfiles.com/deit/deit_small_patch16_224-cd65a155.pth
number of params: 23444360
Test:  [   0/1000]  eta: 0:35:59  n_ways: 5  n_imgs: 100  acc1: 64.0000 (64.0000)  acc5: 100.0000 (100.0000)  loss: 0.9983 (0.9983)  time: 2.1599  data: 0.9132  max mem: 714
Test:  [  10/1000]  eta: 0:06:09  n_ways: 5  n_imgs: 100  acc1: 66.6667 (64.2424)  acc5: 100.0000 (100.0000)  loss: 1.0146 (1.0654)  time: 0.3731  data: 0.0833  max mem: 714
Test:  [  20/1000]  eta: 0:04:31  n_ways: 5  n_imgs: 100  acc1: 62.6667 (62.5397)  acc5: 100.0000 (100.0000)  loss: 1.0317 (1.0656)  time: 0.1828  data: 0.0004  max mem: 714
Test:  [  30/1000]  eta: 0:03:55  n_ways: 5  n_imgs: 100  acc1: 62.6667 (63.4839)  acc5: 100.0000 (100.0000)  loss: 1.0503 (1.0593)  time: 0.1710  data: 0.0004  max mem: 714
Test:  [  40/1000]  eta: 0:03:38  n_ways: 5  n_imgs: 100  acc1: 62.6667 (62.9919)  acc5: 100.0000 (100.0000)  loss: 1.0793 (1.0648)  time: 0.1768  data: 0.0004  max mem: 714
Test:  [  50/1000]  eta: 0:03:26  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.8824)  acc5: 100.0000 (100.0000)  loss: 1.0934 (1.0777)  time: 0.1780  data: 0.0003  max mem: 714
Test:  [  60/1000]  eta: 0:03:17  n_ways: 5  n_imgs: 100  acc1: 62.6667 (62.1639)  acc5: 100.0000 (100.0000)  loss: 1.0905 (1.0751)  time: 0.1739  data: 0.0003  max mem: 714
Test:  [  70/1000]  eta: 0:03:10  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.7840)  acc5: 100.0000 (100.0000)  loss: 1.1060 (1.0860)  time: 0.1728  data: 0.0004  max mem: 714
Test:  [  80/1000]  eta: 0:03:04  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.3169)  acc5: 100.0000 (100.0000)  loss: 1.1136 (1.0914)  time: 0.1704  data: 0.0003  max mem: 714
Test:  [  90/1000]  eta: 0:02:59  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.5385)  acc5: 100.0000 (100.0000)  loss: 1.0988 (1.0883)  time: 0.1701  data: 0.0003  max mem: 714
Test:  [ 100/1000]  eta: 0:02:55  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.2805)  acc5: 100.0000 (100.0000)  loss: 1.0988 (1.0892)  time: 0.1727  data: 0.0004  max mem: 714
Test:  [ 110/1000]  eta: 0:02:51  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.2853)  acc5: 100.0000 (100.0000)  loss: 1.1110 (1.0909)  time: 0.1733  data: 0.0003  max mem: 714
Test:  [ 120/1000]  eta: 0:02:48  n_ways: 5  n_imgs: 100  acc1: 62.6667 (60.9587)  acc5: 100.0000 (100.0000)  loss: 1.1265 (1.0969)  time: 0.1714  data: 0.0003  max mem: 714
Test:  [ 130/1000]  eta: 0:02:45  n_ways: 5  n_imgs: 100  acc1: 62.6667 (60.9262)  acc5: 100.0000 (100.0000)  loss: 1.1132 (1.0931)  time: 0.1784  data: 0.0003  max mem: 714
Test:  [ 140/1000]  eta: 0:02:43  n_ways: 5  n_imgs: 100  acc1: 62.6667 (60.9835)  acc5: 100.0000 (100.0000)  loss: 1.0554 (1.0891)  time: 0.1832  data: 0.0004  max mem: 714
Test:  [ 150/1000]  eta: 0:02:40  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.0861)  acc5: 100.0000 (100.0000)  loss: 1.0134 (1.0885)  time: 0.1808  data: 0.0004  max mem: 714
Test:  [ 160/1000]  eta: 0:02:38  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.1263)  acc5: 100.0000 (100.0000)  loss: 1.0977 (1.0874)  time: 0.1785  data: 0.0004  max mem: 714
Test:  [ 170/1000]  eta: 0:02:36  n_ways: 5  n_imgs: 100  acc1: 61.3333 (60.9357)  acc5: 100.0000 (100.0000)  loss: 1.1225 (1.0890)  time: 0.1785  data: 0.0004  max mem: 714
Test:  [ 180/1000]  eta: 0:02:33  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.0608)  acc5: 100.0000 (100.0000)  loss: 1.0638 (1.0871)  time: 0.1798  data: 0.0004  max mem: 714
Test:  [ 190/1000]  eta: 0:02:31  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.1798)  acc5: 100.0000 (100.0000)  loss: 1.0456 (1.0859)  time: 0.1791  data: 0.0004  max mem: 714
Test:  [ 200/1000]  eta: 0:02:29  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.1542)  acc5: 100.0000 (100.0000)  loss: 1.0783 (1.0877)  time: 0.1816  data: 0.0004  max mem: 714
Test:  [ 210/1000]  eta: 0:02:27  n_ways: 5  n_imgs: 100  acc1: 61.3333 (60.9605)  acc5: 100.0000 (100.0000)  loss: 1.1116 (1.0893)  time: 0.1802  data: 0.0004  max mem: 714
Test:  [ 220/1000]  eta: 0:02:24  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.1161)  acc5: 100.0000 (100.0000)  loss: 1.1109 (1.0861)  time: 0.1748  data: 0.0004  max mem: 714
Test:  [ 230/1000]  eta: 0:02:22  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.0967)  acc5: 100.0000 (100.0000)  loss: 1.0171 (1.0850)  time: 0.1748  data: 0.0004  max mem: 714
Test:  [ 240/1000]  eta: 0:02:20  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.3444)  acc5: 100.0000 (100.0000)  loss: 1.0641 (1.0825)  time: 0.1744  data: 0.0003  max mem: 714
Test:  [ 250/1000]  eta: 0:02:18  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.1474)  acc5: 100.0000 (100.0000)  loss: 1.0718 (1.0847)  time: 0.1727  data: 0.0003  max mem: 714
Test:  [ 260/1000]  eta: 0:02:16  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.1392)  acc5: 100.0000 (100.0000)  loss: 1.1232 (1.0847)  time: 0.1727  data: 0.0003  max mem: 714
Test:  [ 270/1000]  eta: 0:02:14  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.0480)  acc5: 100.0000 (100.0000)  loss: 1.1232 (1.0861)  time: 0.1741  data: 0.0003  max mem: 714
Test:  [ 280/1000]  eta: 0:02:12  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.2242)  acc5: 100.0000 (100.0000)  loss: 1.0984 (1.0825)  time: 0.1825  data: 0.0004  max mem: 714
Test:  [ 290/1000]  eta: 0:02:10  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.2050)  acc5: 100.0000 (100.0000)  loss: 1.0074 (1.0809)  time: 0.1840  data: 0.0004  max mem: 714
Test:  [ 300/1000]  eta: 0:02:08  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.2226)  acc5: 100.0000 (100.0000)  loss: 1.0565 (1.0813)  time: 0.1779  data: 0.0004  max mem: 714
Test:  [ 310/1000]  eta: 0:02:06  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.4234)  acc5: 100.0000 (100.0000)  loss: 1.0434 (1.0793)  time: 0.1748  data: 0.0003  max mem: 714
Test:  [ 320/1000]  eta: 0:02:04  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.5119)  acc5: 100.0000 (100.0000)  loss: 1.0191 (1.0780)  time: 0.1758  data: 0.0004  max mem: 714
Test:  [ 330/1000]  eta: 0:02:02  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.7281)  acc5: 100.0000 (100.0000)  loss: 0.9819 (1.0737)  time: 0.1795  data: 0.0004  max mem: 714
Test:  [ 340/1000]  eta: 0:02:00  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.7400)  acc5: 100.0000 (100.0000)  loss: 0.9979 (1.0729)  time: 0.1767  data: 0.0004  max mem: 714
Test:  [ 350/1000]  eta: 0:01:58  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.6410)  acc5: 100.0000 (100.0000)  loss: 1.0773 (1.0745)  time: 0.1742  data: 0.0004  max mem: 714
Test:  [ 360/1000]  eta: 0:01:56  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.5476)  acc5: 100.0000 (100.0000)  loss: 1.1573 (1.0759)  time: 0.1785  data: 0.0004  max mem: 714
Test:  [ 370/1000]  eta: 0:01:54  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.4591)  acc5: 100.0000 (100.0000)  loss: 1.1049 (1.0771)  time: 0.1777  data: 0.0004  max mem: 714
Test:  [ 380/1000]  eta: 0:01:52  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.3928)  acc5: 100.0000 (100.0000)  loss: 1.0757 (1.0771)  time: 0.1745  data: 0.0003  max mem: 714
Test:  [ 390/1000]  eta: 0:01:50  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.3981)  acc5: 100.0000 (100.0000)  loss: 1.0627 (1.0778)  time: 0.1756  data: 0.0004  max mem: 714
Test:  [ 400/1000]  eta: 0:01:49  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.3998)  acc5: 100.0000 (100.0000)  loss: 1.0591 (1.0771)  time: 0.1797  data: 0.0004  max mem: 714
Test:  [ 410/1000]  eta: 0:01:47  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.2425)  acc5: 100.0000 (100.0000)  loss: 1.1272 (1.0802)  time: 0.1814  data: 0.0004  max mem: 714
Test:  [ 420/1000]  eta: 0:01:45  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.2067)  acc5: 100.0000 (100.0000)  loss: 1.1460 (1.0800)  time: 0.1775  data: 0.0004  max mem: 714
Test:  [ 430/1000]  eta: 0:01:43  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.2189)  acc5: 100.0000 (100.0000)  loss: 1.0405 (1.0802)  time: 0.1748  data: 0.0004  max mem: 714
Test:  [ 440/1000]  eta: 0:01:41  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.2245)  acc5: 100.0000 (100.0000)  loss: 1.0139 (1.0793)  time: 0.1770  data: 0.0004  max mem: 714
Test:  [ 450/1000]  eta: 0:01:39  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.3008)  acc5: 100.0000 (100.0000)  loss: 1.0256 (1.0794)  time: 0.1766  data: 0.0004  max mem: 714
Test:  [ 460/1000]  eta: 0:01:37  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.3420)  acc5: 100.0000 (100.0000)  loss: 1.0499 (1.0788)  time: 0.1747  data: 0.0003  max mem: 714
Test:  [ 470/1000]  eta: 0:01:36  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.4409)  acc5: 100.0000 (100.0000)  loss: 1.0183 (1.0770)  time: 0.1782  data: 0.0003  max mem: 714
Test:  [ 480/1000]  eta: 0:01:34  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.4886)  acc5: 100.0000 (100.0000)  loss: 1.0189 (1.0756)  time: 0.1765  data: 0.0004  max mem: 714
Test:  [ 490/1000]  eta: 0:01:32  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.5071)  acc5: 100.0000 (100.0000)  loss: 1.0199 (1.0748)  time: 0.1722  data: 0.0003  max mem: 714
Test:  [ 500/1000]  eta: 0:01:30  n_ways: 5  n_imgs: 100  acc1: 61.3333 (61.4957)  acc5: 100.0000 (100.0000)  loss: 1.0148 (1.0747)  time: 0.1744  data: 0.0003  max mem: 714
Test:  [ 510/1000]  eta: 0:01:28  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.5342)  acc5: 100.0000 (100.0000)  loss: 1.0106 (1.0743)  time: 0.1755  data: 0.0003  max mem: 714
Test:  [ 520/1000]  eta: 0:01:26  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.5176)  acc5: 100.0000 (100.0000)  loss: 1.0278 (1.0748)  time: 0.1738  data: 0.0003  max mem: 714
Test:  [ 530/1000]  eta: 0:01:24  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.5719)  acc5: 100.0000 (100.0000)  loss: 1.0491 (1.0737)  time: 0.1733  data: 0.0003  max mem: 714
Test:  [ 540/1000]  eta: 0:01:22  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.6340)  acc5: 100.0000 (100.0000)  loss: 1.0258 (1.0731)  time: 0.1745  data: 0.0003  max mem: 714
Test:  [ 550/1000]  eta: 0:01:21  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.6479)  acc5: 100.0000 (100.0000)  loss: 1.0135 (1.0729)  time: 0.1747  data: 0.0003  max mem: 714
Test:  [ 560/1000]  eta: 0:01:19  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.6922)  acc5: 100.0000 (100.0000)  loss: 1.0209 (1.0729)  time: 0.1745  data: 0.0003  max mem: 714
Test:  [ 570/1000]  eta: 0:01:17  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.7023)  acc5: 100.0000 (100.0000)  loss: 1.0719 (1.0727)  time: 0.1762  data: 0.0003  max mem: 714
Test:  [ 580/1000]  eta: 0:01:15  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.6454)  acc5: 100.0000 (100.0000)  loss: 1.0779 (1.0737)  time: 0.1761  data: 0.0004  max mem: 714
Test:  [ 590/1000]  eta: 0:01:13  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.6153)  acc5: 100.0000 (100.0000)  loss: 1.0449 (1.0737)  time: 0.1792  data: 0.0003  max mem: 714
Test:  [ 600/1000]  eta: 0:01:11  n_ways: 5  n_imgs: 100  acc1: 62.6667 (61.5885)  acc5: 100.0000 (100.0000)  loss: 1.0374 (1.0739)  time: 0.1769  data: 0.0004  max mem: 714
