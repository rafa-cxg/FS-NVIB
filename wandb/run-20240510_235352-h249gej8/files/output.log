Not using distributed mode
Namespace(batch_size=1, num_classes=1000, epochs=100, fp16=False, output_dir='outputs/original_diet_small_lr1e-4', device='cuda:0', seed=0, data_path='/datasets01/imagenet_full_size/061417/', pretrained_checkpoint_path='.', dataset='cifar_fs', nClsEpisode=5, nSupport=5, nQuery=15, nValEpisode=120, nEpisode=2000, image_size=128, base_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], val_sources=['aircraft', 'cu_birds', 'dtd', 'fungi', 'ilsvrc_2012', 'omniglot', 'quickdraw', 'vgg_flower'], test_sources=['traffic_sign', 'mscoco', 'ilsvrc_2012', 'omniglot', 'aircraft', 'cu_birds', 'dtd', 'quickdraw', 'fungi', 'vgg_flower'], shuffle=True, train_transforms=['random_resized_crop', 'jitter', 'random_flip', 'to_tensor', 'normalize'], test_transforms=['resize', 'center_crop', 'to_tensor', 'normalize'], num_ways=None, num_support=None, num_query=None, min_ways=5, max_ways_upper_bound=50, max_num_query=10, max_support_set_size=500, max_support_size_contrib_per_class=100, min_examples_in_class=0, min_log_weight=-0.6931471805599453, max_log_weight=0.6931471805599453, ignore_bilevel_ontology=False, ignore_dag_ontology=False, ignore_hierarchy_probability=0.0, test_n_way=5, n_shot=5, cdfsl_domains=['EuroSAT', 'ISIC', 'CropDisease', 'ChestX'], arch='deit_small_patch16', patch_size=16, pretrained_weights='', checkpoint_key='teacher', unused_params=False, no_pretrain=False, deploy='vanilla', num_adapters=1, ada_steps=40, ada_lr=0.05, aug_prob=0.9, aug_types=['color', 'translation'], img_size=224, drop=0.0, drop_path=0.1, model_ema=False, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', lr=1e-06, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=1e-06, min_lr=1e-06, decay_epochs=30, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, color_jitter=0.4, aa='rand-m9-mstd0.5-inc1', smoothing=0.0, train_interpolation='bicubic', repeated_aug=False, reprob=0.25, remode='pixel', recount=1, resplit=False, mixup=0.0, cutmix=0.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', teacher_model='regnety_160', teacher_path='', distillation_type='none', distillation_alpha=0.5, distillation_tau=1.0, resume='', start_epoch=0, eval=False, dist_eval=False, num_workers=10, pin_mem=True, world_size=1, dist_url='env://', nvib=False, delta=1.0, alpha_tau=0.0, stdev_tau=0.0, lambda_klg=0.001, lambda_kld=0.001, nvib_layers=[0, 1, 2, 3, 4, 5], distributed=False)
Creating model: ProtoNet deit_small_patch16
removing key head.weight from pretrained checkpoint
removing key head.bias from pretrained checkpoint
Pretrained weights found at https://dl.fbaipublicfiles.com/deit/deit_small_patch16_224-cd65a155.pth
number of params: 21665666
Test:  [   0/1000]  eta: 0:24:09  n_ways: 5  n_imgs: 100  acc1: 77.3333 (77.3333)  acc5: 100.0000 (100.0000)  loss: 0.7622 (0.7622)  time: 1.4498  data: 0.5003  max mem: 434
Test:  [  10/1000]  eta: 0:03:23  n_ways: 5  n_imgs: 100  acc1: 77.3333 (77.3333)  acc5: 100.0000 (100.0000)  loss: 0.7930 (0.7842)  time: 0.2060  data: 0.0458  max mem: 434
Test:  [  20/1000]  eta: 0:02:23  n_ways: 5  n_imgs: 100  acc1: 77.3333 (77.2698)  acc5: 100.0000 (100.0000)  loss: 0.7930 (0.7736)  time: 0.0817  data: 0.0004  max mem: 434
Test:  [  30/1000]  eta: 0:02:02  n_ways: 5  n_imgs: 100  acc1: 76.0000 (76.0430)  acc5: 100.0000 (100.0000)  loss: 0.8188 (0.7832)  time: 0.0831  data: 0.0004  max mem: 434
Test:  [  40/1000]  eta: 0:01:51  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.6098)  acc5: 100.0000 (100.0000)  loss: 0.8099 (0.7888)  time: 0.0840  data: 0.0005  max mem: 434
Test:  [  50/1000]  eta: 0:01:44  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.8431)  acc5: 100.0000 (100.0000)  loss: 0.7717 (0.7899)  time: 0.0829  data: 0.0005  max mem: 434
Test:  [  60/1000]  eta: 0:01:38  n_ways: 5  n_imgs: 100  acc1: 76.0000 (76.3716)  acc5: 100.0000 (100.0000)  loss: 0.7650 (0.7862)  time: 0.0823  data: 0.0005  max mem: 434
Test:  [  70/1000]  eta: 0:01:34  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.4554)  acc5: 100.0000 (100.0000)  loss: 0.8029 (0.7999)  time: 0.0822  data: 0.0004  max mem: 434
Test:  [  80/1000]  eta: 0:01:31  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.9959)  acc5: 100.0000 (100.0000)  loss: 0.8689 (0.8085)  time: 0.0821  data: 0.0004  max mem: 434
Test:  [  90/1000]  eta: 0:01:28  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.9011)  acc5: 100.0000 (100.0000)  loss: 0.8156 (0.8071)  time: 0.0821  data: 0.0005  max mem: 434
Test:  [ 100/1000]  eta: 0:01:26  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.6931)  acc5: 100.0000 (100.0000)  loss: 0.7792 (0.8058)  time: 0.0823  data: 0.0005  max mem: 434
Test:  [ 110/1000]  eta: 0:01:24  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.5826)  acc5: 100.0000 (100.0000)  loss: 0.8178 (0.8089)  time: 0.0825  data: 0.0005  max mem: 434
Test:  [ 120/1000]  eta: 0:01:22  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.4242)  acc5: 100.0000 (100.0000)  loss: 0.8264 (0.8112)  time: 0.0821  data: 0.0004  max mem: 434
Test:  [ 130/1000]  eta: 0:01:20  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.4529)  acc5: 100.0000 (100.0000)  loss: 0.8073 (0.8100)  time: 0.0823  data: 0.0006  max mem: 434
Test:  [ 140/1000]  eta: 0:01:19  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.4492)  acc5: 100.0000 (100.0000)  loss: 0.8106 (0.8071)  time: 0.0831  data: 0.0006  max mem: 434
Test:  [ 150/1000]  eta: 0:01:17  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.4812)  acc5: 100.0000 (100.0000)  loss: 0.7821 (0.8060)  time: 0.0835  data: 0.0006  max mem: 434
Test:  [ 160/1000]  eta: 0:01:16  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.6335)  acc5: 100.0000 (100.0000)  loss: 0.7711 (0.8043)  time: 0.0834  data: 0.0006  max mem: 434
Test:  [ 170/1000]  eta: 0:01:16  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.7680)  acc5: 100.0000 (100.0000)  loss: 0.7711 (0.8043)  time: 0.0922  data: 0.0084  max mem: 434
Test:  [ 180/1000]  eta: 0:01:15  n_ways: 5  n_imgs: 100  acc1: 74.6667 (74.8140)  acc5: 100.0000 (100.0000)  loss: 0.7503 (0.8039)  time: 0.1034  data: 0.0199  max mem: 434
Test:  [ 190/1000]  eta: 0:01:15  n_ways: 5  n_imgs: 100  acc1: 74.6667 (75.0157)  acc5: 100.0000 (100.0000)  loss: 0.7458 (0.8015)  time: 0.1008  data: 0.0183  max mem: 434
Test:  [ 200/1000]  eta: 0:01:13  n_ways: 5  n_imgs: 100  acc1: 74.6667 (75.0846)  acc5: 100.0000 (100.0000)  loss: 0.7330 (0.7999)  time: 0.0910  data: 0.0079  max mem: 434
Test:  [ 210/1000]  eta: 0:01:12  n_ways: 5  n_imgs: 100  acc1: 74.6667 (75.0079)  acc5: 100.0000 (100.0000)  loss: 0.7947 (0.8002)  time: 0.0874  data: 0.0046  max mem: 434
Test:  [ 220/1000]  eta: 0:01:11  n_ways: 5  n_imgs: 100  acc1: 74.6667 (75.0649)  acc5: 100.0000 (100.0000)  loss: 0.7620 (0.7977)  time: 0.0857  data: 0.0037  max mem: 434
Test:  [ 230/1000]  eta: 0:01:10  n_ways: 5  n_imgs: 100  acc1: 74.6667 (75.0303)  acc5: 100.0000 (100.0000)  loss: 0.7602 (0.7971)  time: 0.0828  data: 0.0007  max mem: 434
Test:  [ 240/1000]  eta: 0:01:09  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.1923)  acc5: 100.0000 (100.0000)  loss: 0.7193 (0.7940)  time: 0.0826  data: 0.0004  max mem: 434
Test:  [ 250/1000]  eta: 0:01:07  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.2085)  acc5: 100.0000 (100.0000)  loss: 0.7614 (0.7951)  time: 0.0826  data: 0.0004  max mem: 434
Test:  [ 260/1000]  eta: 0:01:06  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.2286)  acc5: 100.0000 (100.0000)  loss: 0.7801 (0.7952)  time: 0.0826  data: 0.0005  max mem: 434
Test:  [ 270/1000]  eta: 0:01:05  n_ways: 5  n_imgs: 100  acc1: 74.6667 (75.1439)  acc5: 100.0000 (100.0000)  loss: 0.8217 (0.7965)  time: 0.0825  data: 0.0004  max mem: 434
Test:  [ 280/1000]  eta: 0:01:04  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.3499)  acc5: 100.0000 (100.0000)  loss: 0.7701 (0.7933)  time: 0.0828  data: 0.0005  max mem: 434
Test:  [ 290/1000]  eta: 0:01:03  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.3769)  acc5: 100.0000 (100.0000)  loss: 0.7118 (0.7925)  time: 0.0826  data: 0.0005  max mem: 434
Test:  [ 300/1000]  eta: 0:01:02  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.2159)  acc5: 100.0000 (100.0000)  loss: 0.7747 (0.7945)  time: 0.0822  data: 0.0004  max mem: 434
Test:  [ 310/1000]  eta: 0:01:01  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.3998)  acc5: 100.0000 (100.0000)  loss: 0.7201 (0.7913)  time: 0.0823  data: 0.0004  max mem: 434
Test:  [ 320/1000]  eta: 0:01:00  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.4019)  acc5: 100.0000 (100.0000)  loss: 0.7024 (0.7914)  time: 0.0822  data: 0.0004  max mem: 434
Test:  [ 330/1000]  eta: 0:00:59  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.6254)  acc5: 100.0000 (100.0000)  loss: 0.6945 (0.7872)  time: 0.0823  data: 0.0004  max mem: 434
Test:  [ 340/1000]  eta: 0:00:58  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.6872)  acc5: 100.0000 (100.0000)  loss: 0.6945 (0.7867)  time: 0.0824  data: 0.0004  max mem: 434
Test:  [ 350/1000]  eta: 0:00:57  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.5784)  acc5: 100.0000 (100.0000)  loss: 0.7969 (0.7880)  time: 0.0832  data: 0.0005  max mem: 434
Test:  [ 360/1000]  eta: 0:00:56  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.3832)  acc5: 100.0000 (100.0000)  loss: 0.8018 (0.7908)  time: 0.0833  data: 0.0005  max mem: 434
Test:  [ 370/1000]  eta: 0:00:55  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.3279)  acc5: 100.0000 (100.0000)  loss: 0.7828 (0.7917)  time: 0.0827  data: 0.0005  max mem: 434
Test:  [ 380/1000]  eta: 0:00:54  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.3001)  acc5: 100.0000 (100.0000)  loss: 0.7828 (0.7922)  time: 0.0827  data: 0.0005  max mem: 434
Test:  [ 390/1000]  eta: 0:00:53  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.2907)  acc5: 100.0000 (100.0000)  loss: 0.7779 (0.7926)  time: 0.0826  data: 0.0005  max mem: 434
Test:  [ 400/1000]  eta: 0:00:52  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.2652)  acc5: 100.0000 (100.0000)  loss: 0.7779 (0.7933)  time: 0.0823  data: 0.0004  max mem: 434
Test:  [ 410/1000]  eta: 0:00:51  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.1565)  acc5: 100.0000 (100.0000)  loss: 0.8535 (0.7956)  time: 0.0822  data: 0.0004  max mem: 434
Test:  [ 420/1000]  eta: 0:00:50  n_ways: 5  n_imgs: 100  acc1: 74.6667 (75.0277)  acc5: 100.0000 (100.0000)  loss: 0.8662 (0.7963)  time: 0.0823  data: 0.0004  max mem: 434
Test:  [ 430/1000]  eta: 0:00:49  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.0596)  acc5: 100.0000 (100.0000)  loss: 0.8348 (0.7967)  time: 0.0823  data: 0.0004  max mem: 434
Test:  [ 440/1000]  eta: 0:00:48  n_ways: 5  n_imgs: 100  acc1: 74.6667 (75.1081)  acc5: 100.0000 (100.0000)  loss: 0.7437 (0.7956)  time: 0.0837  data: 0.0005  max mem: 434
Test:  [ 450/1000]  eta: 0:00:47  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.1308)  acc5: 100.0000 (100.0000)  loss: 0.7321 (0.7950)  time: 0.0864  data: 0.0024  max mem: 434
Test:  [ 460/1000]  eta: 0:00:47  n_ways: 5  n_imgs: 100  acc1: 76.0000 (75.1265)  acc5: 100.0000 (100.0000)  loss: 0.7760 (0.7947)  time: 0.0860  data: 0.0033  max mem: 434
